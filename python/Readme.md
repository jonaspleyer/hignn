# Training pipline
## 1. Data generation
The date is generated by the code of stokesian dynamics (SD) in https://github.com/Pecnut/stokesian-dynamics. Please be sure to **FULLY** understand the code and install it. I used their code in python 2.7 for SD but they recently update it to python 3.8. So my code generation script can not be directly used here. I just provided for reference and you will need to rewrite it for python 3.8.

The general steps to generate code is as following:
1. Make sure the boundary condition that we want! Unbounded or periodic? If periodic, what size?
2. 1 body: If unbounded, the velocity of a particle is 1 when applying a force of 1. If periodic, run a simulation with one particle for one step. **Note that the results may need to be nondimensionalized by 6 \pi from stokes law.**
3. 2 body: Generate samples of two particles (make sure they have been distributed over all the domain of interest); modify generate_velocity_2body.py according to the boundary conditions and input force; run it to generate code.
4. 3 body: Generate samples of three particles (usually the distance between two particles can be smaller than the cutoff distance); modify generate_velocity_3body.py according to the boundary conditions and input force; run it to generate code.

Note: input_setups.py includes the input mode, which also needs to be modified according to the boundary condition and force.

## 2. Training model
The script train_velocity.py can be run in the enviroment of current docker. I provide a case to train the model for periodic box of 32. 

Some things to be noted:

1. This script in training needs knowledge of the data generation, for example how the force is added in data generation, so make sure you fully read the code.
2. There is another better way to generate the edge and build the graph, but currently it can not be applied due to the incompatibility issue.
3. You can finetune the hyperparameter to train the model.

